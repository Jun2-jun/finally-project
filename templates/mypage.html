<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>마이페이지</title> 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/mypage.css') }}">
</head>
<body>
    <div class="container">
        <h2>마이페이지</h2>
        <form method="POST" action="/mypage" id="mypage-form">
            <div class="form-group">
                <i class="fas fa-user form-icon"></i>
                <input type="text" class="form-control" name="userid" value="{{ user.userid }}" readonly>
            </div>

            <div class="form-group">
                <i class="fas fa-envelope form-icon"></i>
                <input type="email" class="form-control editable" name="email" value="{{ user.email }}" readonly>
            </div>

            <div class="form-group">
                <label class="mb-1">생년월일:</label>
                <input type="date" class="form-control editable" name="birthdate" value="{{ user.birthdate }}" readonly>
            </div>

            <div class="form-group">
                <i class="fas fa-phone form-icon"></i>
                <input type="text" class="form-control editable" name="phone" value="{{ user.phone }}" readonly>
            </div>

            <div class="form-group">
                <i class="fas fa-map-marker-alt form-icon"></i>
                <input type="text" class="form-control editable" name="address" value="{{ user.address }}" readonly>
                <button type="button" class="search-button"><i class="fas fa-search"></i></button>
            </div>

            <div class="form-group">
                <input type="text" class="form-control editable" name="detail_address" value="{{ user.detail_address }}" readonly>
            </div>

            <div class="btn-wrap">
                <a href="/change_password" class="btn btn-submit">비밀번호 변경</a>
                <button type="button" class="btn btn-submit" id="edit-btn">수정하기</button>
            </div>

            <!-- 홈으로 돌아가기 버튼은 form 안에, btn-wrap 밖에 정확히 위치 -->
            <div class="mt-3">
                <a href="/dashboard" class="btn btn-submit w-100">
                    <i class="fas fa-home me-2"></i> 홈 화면으로 돌아가기</a>
            </div>
            <!-- 탈퇴하기 텍스트 (클릭 시 모달 열림) -->
            <div class="text-center mt-2">
                <span class="withdraw-link" onclick="openModal()">탈퇴하기</span></div>

            <div id="withdrawModal" class="modal-overlay">
                <div class="modal-content text-center">
                  
                  <!-- 닫기 버튼 -->
                  <button class="modal-close-btn" onclick="closeModal()">x</button>
                  <p class="mb-3 fw-bold" style="font-size: 22px;">정말 탈퇴하시겠습니까?</p>
                  <input type="password" id="withdrawPassword" class="form-control mb-2" placeholder="비밀번호 입력">
                  <p id="withdrawError" class="text-start" style="display: none; font-size: 14px; margin-bottom: 10px; color: #999;">비밀번호가 일치하지 않습니다.</p>
                  <a href="#" class="withdraw-link text-danger" onclick="submitWithdraw()" style="margin-top: 30px;">탈퇴하기</a>
                </div>
              </div>

        </form>
    </div>
    <!-- 다이얼로그 띄우기 및 사라지기 -->
    <script>
        function openModal() {
          document.getElementById("withdrawModal").style.display = "flex";
        }
        function closeModal() {
          document.getElementById("withdrawModal").style.display = "none";
        }
    </script>

    <!-- 분리된 JS 파일 로드 -->
    <script src="{{ url_for('static', filename='js/mypage.js') }}"></script>
</body>
</html>
